<!DOCTYPE html> <html lang="en"> <head> <meta name="google-site-verification" content="XGpY7kLsPO8XuKvrJZpPOei3vNAs2zJByAuqqBe6JxE"/> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Embedded Linux Image Builder | Masoud Rahimi</title> <meta name="author" content="Masoud Rahimi"/> <meta name="description" content="Build an embedded Linux image from scratch with Docker."/> <meta name="keywords" content="masoud rahimi, phd student, electrical engineering, embedded system engineer, concordia"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/favicon.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://masoudrahimi.com/projects/1_project/"> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> <script src="/assets/js/jquery.smoothState.js"></script> <script src="/assets/js/page_transition.js"></script> <script src="https://www.google.com/recaptcha/api.js"></script> </head> <body class="fixed-top-nav "> <div class="m-scene" id="main"> <div class="scene_element scene_element--fadein"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://masoudrahimi.com/"><span class="font-weight-bold">Masoud</span> Rahimi</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Home</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">Vitae</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching</a> </li> <li class="nav-item "> <a class="nav-link" href="/contact/">Contact</a> </li> </ul> </div> </div> </nav> </header> <div id="particles-js"></div> <div class="container mt-5"> <div id="padding"> <div class="post"> <header class="post-header"> <h1 class="post-title">Embedded Linux Image Builder</h1> <p class="post-description">Build an embedded Linux image from scratch with Docker.</p> </header> <article> <p>Embedded Linux systems are so common these days, and they can be found in set-top boxes, smart TVs, network devices (like routers, 3G/4G USB modems), etc. For the developers, a major concern with these systems is creating their own custom Linux distribution based on their needs, including creating the image for the development or the final product. Making the image usually consists of compiling the Linux kernel, device tree binaries, compiling Bootloader, and customizing the Linux file system. These steps may become frustrating if you want to test something or try to rebuild the image over and over. On the other side, creating the environment for cross-compiling is a little complicated as you need to set a special environment for the ARM toolchain.</p> <p>There are many automated tools to achieve this, like <a href="https://buildroot.org/" target="_blank" rel="noopener noreferrer">Buildroot</a> and <a href="https://www.yoctoproject.org/" target="_blank" rel="noopener noreferrer">Yocto Project</a>. They usually give you a minimal version of the Linux image and are a good choice for the final image that is intended to use in the production environment, but for the development environment, they are not always the best choice because of lacking package manager or external tools. Another choice is to create your own custom Linux image by compiling the kernel, Bootloader, and file system, and finally bring them all together and put it into the device’s SD card or flash storage. With the <a href="https://www.docker.com/" target="_blank" rel="noopener noreferrer">Docker</a>, you can do this simply and don’t need to mess around with your host. Moreover, you can use the setup on Mac or Windows machines.</p> <p>I created a simple Docker project to achieve this. It can be customized to use with any embedded Linux board and can be developed easily. I’ve tested it with <a href="https://beagleboard.org/black" target="_blank" rel="noopener noreferrer">BeagleBone Black</a>, but with a little change can be used on other educational development boards like <a href="https://www.raspberrypi.org/" target="_blank" rel="noopener noreferrer">Raspberry Pi</a>, <a href="http://nanopi.io/" target="_blank" rel="noopener noreferrer">Nano Pi</a>, etc. You can also use it on your own customized embedded Linux board, but you need to provide your configuration file for the kernel or Bootloader. All you need to do is to provide the resource binaries for the Linux kernel, Bootloader, and filesystem, then start the build with a single command <code class="language-plaintext highlighter-rouge">docker-compose up</code>. The output is a standard image file that can be written on the SD card easily. Also, it uses the Linaro toolchain for cross-compilation, so it is fast and reliable.</p> <p>Although the project use is relatively straightforward, I’ve made a step-by-step guide. So let’s go into details and how to set it up.</p> <p>For using this project, you don’t need to set up any special environment or meet any special requirements. I’ve used BeagleBone Black as the target system with Ubuntu 18.04 and Ti’s Linux Kernel 4.19.94.</p> <h2 id="features">Features</h2> <ul> <li>Based on Docker so can be run on any machine without any requirements.</li> <li>Build Kernel, DTS, modules, and headers from the source.</li> <li>Build Bootloader (u-boot) from the source.</li> <li>Can be combined with any Linux distribution.</li> <li>Create image file (.img) as output file for easy writing to SD card.</li> <li>High-speed build with the help of using Linaro toolchain and Docker engine.</li> <li>Can be used with any Embedded Linux system with little configuration change.</li> </ul> <h2 id="requirements">Requirements</h2> <ul> <li> <a href="https://docs.docker.com/install/" target="_blank" rel="noopener noreferrer">Docker</a> and <a href="https://docs.docker.com/compose/install/" target="_blank" rel="noopener noreferrer">Docker Compose</a> </li> <li>If you are using Windows, make sure to use the latest <a href="https://docs.docker.com/docker-for-windows/wsl/" target="_blank" rel="noopener noreferrer">WSL 2</a> backend as the device-mapper kernel driver is missing in older WSL versions. Otherwise, you need to build the SD Card manually.</li> <li>Download resource files and put them in the <code class="language-plaintext highlighter-rouge">resources</code> directory: <ul> <li>Linaro cross-compile toolchain. <ul> <li>You can get the binaries from <a href="https://www.linaro.org/downloads/" target="_blank" rel="noopener noreferrer">here</a>.</li> </ul> </li> <li>Linux Kernel source for your board. <ul> <li>For BeagleBone Black, you can use the official <a href="https://github.com/beagleboard/linux" target="_blank" rel="noopener noreferrer">kernel</a> </li> </ul> </li> <li>u-boot <a href="https://github.com/u-boot/u-boot" target="_blank" rel="noopener noreferrer">source code</a>.</li> <li>A base rootfs Linux distro. <ul> <li>You can grab Ubuntu or Debian distro from <a href="https://rcn-ee.com/rootfs/eewiki/minfs/" target="_blank" rel="noopener noreferrer">here</a>.</li> <li> <a href="https://rcn-ee.com/rootfs/eewiki/minfs/ubuntu-18.04.3-minimal-armhf-2020-02-10.tar.xz" target="_blank" rel="noopener noreferrer">Ubuntu 18.04.3</a> used in this project.</li> </ul> </li> <li>As the compile process may take longer, you need to increase the Docker engine resources.</li> </ul> </li> </ul> <h2 id="how-to-use">How to use</h2> <ol> <li>Make sure that you meet the requirements and put the necessary files into the <code class="language-plaintext highlighter-rouge">resources</code> directory: <ul> <li> <p>For example:</p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>project
└───resources
│   │   armhf-rootfs-ubuntu-bionic.tar
│   │   gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf.tar
│   │   linux-4.19.94-ti-rt-r41.tar.gz
│   │   u-boot-2020.04-rc3.tar.gz

</code></pre></div> </div> </li> </ul> </li> <li>Make sure to decompress the Linux rootfs to get the right compressed file. The files contain all the Linux rootfs inside its root directory (e.g., <code class="language-plaintext highlighter-rouge">armhf-rootfs-ubuntu-bionic.tar</code>).</li> <li>Set the Dockerfile parameters in <code class="language-plaintext highlighter-rouge">docker-compose.yml</code>: <ul> <li> <code class="language-plaintext highlighter-rouge">kernel_version</code>: kernel version in X.Y.Z format</li> <li> <code class="language-plaintext highlighter-rouge">kernel_filename</code>: kernel source file path</li> <li> <code class="language-plaintext highlighter-rouge">kernel_defconfig</code>: kernel configuration file</li> <li> <code class="language-plaintext highlighter-rouge">uboot_filename</code>: u-boot source file path</li> <li> <code class="language-plaintext highlighter-rouge">uboot_defconfig</code>: u-boot configuration file</li> <li> <code class="language-plaintext highlighter-rouge">rootfs_filename</code>: Linux Root file system path</li> <li> <code class="language-plaintext highlighter-rouge">linaro_filename</code>: Linaro toolchain file path</li> </ul> </li> <li> <p>Bring up the console and navigate to the project root directory, and execute</p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>docker-compose up <span class="nt">--build</span>
</code></pre></div> </div> </li> <li> <p>If the process is complete successfully, you should get the image file <code class="language-plaintext highlighter-rouge">sd_image.img</code> and <code class="language-plaintext highlighter-rouge">rootfs.tar.gz</code> in the <code class="language-plaintext highlighter-rouge">output</code> directory.</p> </li> <li>You can write <code class="language-plaintext highlighter-rouge">sd_image.sd</code> directly to the SD Card or manually partition your SD and copy the contents of <code class="language-plaintext highlighter-rouge">rootfs.tar.gz</code> into the SD partitions.</li> </ol> <h2 id="contribution">Contribution</h2> <p>Project source code can be found <a href="https://github.com/masoudr/embedded-linux-image-builder" target="_blank" rel="noopener noreferrer">here</a>. Reporting any bugs or suggestions for improvement would be appreciated.</p> </article> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2026 Masoud Rahimi. Powered by <a style="font-weight:bold" href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <img class="emoji" title=":heart:" alt=":heart:" src="https://github.githubassets.com/images/icons/emoji/unicode/2764.png" height="20" width="20"> | Last updated: February 22, 2026. </div> </footer> </div> </div> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script async src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script> <script async src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script> <script async src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/particles.js"></script> <script src="/assets/js/theme.js"></script> </body> </html>